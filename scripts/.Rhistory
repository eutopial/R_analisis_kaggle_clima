library (tidyverse)
library(broom)
library (ggmap)
library(readr)
library(lubridate)
library(naniar)
library(trend)
library(moments)
library(tseries)
library(boot)
Argentina_weather_data <- read_csv("Documentos/mpd/datos/Argentina_weather_data.csv",
col_types = cols(Country = col_skip(),
Date = col_date(format = "%d-%m-%Y")))
Argentina_weather_data <- read_csv("Documentos/mpd/datos/Argentina_weather_data.csv",
col_types = cols(Country = col_skip(),
Date = col_date(format = "%d-%m-%Y")))
Argentina_weather_data <- read_csv("~/Documentos/mpd/datos/Argentina_weather_data.csv",
col_types = cols(Country = col_skip(),
Date = col_date(format = "%d-%m-%Y")))
#creo la columna estacion para las estaciones del año
Argentina_weather_data <-Argentina_weather_data  %>%
mutate(Date = as.Date(Date),
mes = month(Date, label = TRUE, abbr = FALSE),
año = year(Date),
estacion = case_when(
mes %in% c("diciembre", "enero", "febrero") ~ 1, #vrano
mes %in% c("marzo", "abril", "mayo") ~ 2, #otoño
mes %in% c("junio", "julio", "agosto") ~ 3, #invierno
mes %in% c("septiembre", "octubre", "noviembre") ~ 4 )) #primavera
#agrupo por año y estacion me quedo la maxima temperatura de la minima la media y la maxima
Argentina_weather_data_group <-Argentina_weather_data %>%
group_by(año, estacion) %>%
summarise(tmin = max(Temp_Min, na.rm = TRUE),
tmax = max(Temp_Max, na.rm = TRUE),
tmedia = max(Temp_Mean, na.rm = TRUE),
.groups = "drop") %>%
mutate(año = as.Date(paste(año, "01", "01", sep = "-")))
#etiquetas para el grafico
Argentina_weather_data_group <- Argentina_weather_data_group %>%
mutate(estacion = factor(estacion,
levels = 1:4,
labels = c("verano", "otono", "invierno", "primavera")))
# agrupo la temperatura para poderla graficar
tl_largo <- Argentina_weather_data_group %>%
pivot_longer(cols = c(tmin, tmax,  tmedia),
names_to = "tipo",
values_to = "valor")
modelo_min <- lm(tmin ~ año, data = Argentina_weather_data_group)
modelo_max <- lm(tmax ~ año, data = Argentina_weather_data_group)
modelo_med <- lm(tmedia ~ año, data = Argentina_weather_data_group)
resultados_reg <- bind_rows(
tidy(modelo_min) %>% mutate(tipo = "min"),
tidy(modelo_max) %>% mutate(tipo = "max"),
tidy(modelo_med) %>% mutate(tipo = "media")
)
print(resultados_reg)
variables <- c("tmin", "tmax", "tmedia")
resultados_mk <- map_df(variables, ~ mk.test(Argentina_weather_data_group[[.x]]) %>%
broom::tidy() %>% mutate(var = .x))
resultados_mk
variables <- c("tmin", "tmax", "tmedia", "Sunshine_Duration", "Precipitation_Sum")
resultados_mk <- map_df(variables, ~ mk.test(Argentina_weather_data_group[[.x]]) %>%
broom::tidy() %>% mutate(var = .x))
variables <- c("tmin", "tmax", "tmedia", "Precipitation_Sum")
resultados_mk <- map_df(variables, ~ mk.test(Argentina_weather_data_group[[.x]]) %>%
broom::tidy() %>% mutate(var = .x))
variables <- c("tmin", "tmax", "tmedia")
resultados_mk <- map_df(variables, ~ mk.test(Argentina_weather_data_group[[.x]]) %>%
broom::tidy() %>% mutate(var = .x))
resultados_mk
#graficos 3 ----------------------
# densidad por grupos
i <- ggplot(Argentina_weather_data_group, aes(x = tmax, color = estacion)) +
geom_density()
plot(i)
#graficos 3 ----------------------
# densidad por grupos
i <- ggplot(Argentina_weather_data_group, aes(x = Precipitation_Sum, color = estacion)) +
geom_density()
plot(i)
#graficos 3 ----------------------
# densidad por grupos
i <- ggplot(Argentina_weather_data_group, aes(x = tmin, color = estacion)) +
geom_density()
plot(i)
#graficos 3 ----------------------
# densidad por grupos
i <- ggplot(Argentina_weather_data, aes(x = Precipitation_Sum, color = estacion)) +
geom_density()
plot(i)
#graficos 3 ----------------------
# densidad por grupos
i <- ggplot(Argentina_weather_data, aes(x = Sunshine_Duration, color = estacion)) +
geom_density()
plot(i)
#graficos 3 ----------------------
# densidad por grupos
i <- ggplot(Argentina_weather_data_group, aes(x = tmin, color = estacion)) +
geom_density()
plot(i)
